#!/bin/bash

python $NETKIT_HOME/python/check.py "$PWD/" $@

NETKIT_ALL=1
for i in "$@"
do
case $i in
    --list)
    NETKIT_LIST=1
    #shift 
    ;;
    -*)
    #shift 
    ;;
    *)
    $NETKIT_HOME/wrapper/bin/netkit_dw rm -f netkit_${UID}_$i; NETKIT_ALL=0
    #shift
    ;;
esac
done

export RC=$?
if [ "$RC" = "0" ]; then

    M=_machines
    L=_links
    if [ "$NETKIT_ALL" = "1" ]; then
        python $NETKIT_HOME/python/folder_hash.py "$PWD/" $@ | while read in; do ($NETKIT_HOME/wrapper/bin/netkit_dw rm -f `cat "$HOME/netkit_temp/$in$M"`; rm "$HOME/netkit_temp/$in$M"); done
    fi
    python $NETKIT_HOME/python/folder_hash.py "$PWD/" $@ | while read in; do ($NETKIT_HOME/wrapper/bin/netkit_dw network rm `cat "$HOME/netkit_temp/$in$L"`); done
    if [ "$NETKIT_ALL" = "1" ]; then
        rm "$HOME/netkit_temp/`python $NETKIT_HOME/python/folder_hash.py "$PWD/" $@`_links"
    fi

else
    echo FAILED
fi
