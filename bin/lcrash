#!/bin/bash

python $NETKIT_HOME/python/check.py "$PWD/" $@

NETKIT_LIST=0
NETKIT_ALL=1
for i in "$@"
do
case $i in
    --list)
    NETKIT_LIST=1
    #shift 
    ;;
    *)
    $NETKIT_HOME/wrapper/bin/netkit_dw kill netkit_${UID}_$i; NETKIT_ALL=0
    #shift
    ;;
esac
done

export RC=$?
if [ "$RC" = "0" ]; then

    if [ "$NETKIT_ALL" = "1" ]; then
        M=_machines
        python $NETKIT_HOME/python/folder_hash.py "$PWD/" $@ | while read in; do ($NETKIT_HOME/wrapper/bin/netkit_dw kill `cat "$HOME/netkit_temp/$in$M"`); done
    fi

    if [ "$NETKIT_LIST" = "1" ]; then
        $NETKIT_HOME/wrapper/bin/netkit_dw ps -a; $NETKIT_HOME/wrapper/bin/netkit_dw network list
    fi

else
    echo FAILED
fi
